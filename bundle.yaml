machines:
  "1":
    constraints: "mem=2G"
    series: "trusty"
  "2":
    constraints: "mem=2G"
    series: "trusty"
  "3":
    constraints: "mem=2G"
    series: "trusty"
  "4":
    constraints: "mem=2G"
    series: "trusty"
services:
  # 42U default rack
  rack:
    charm: ./dist/trusty/rack
    num_units: 1
    annotations:
      gui-x: "300"
      gui-y: "300"
    to:
      - "1"

  # generic PDU
  pdu:
    charm: ./dist/trusty/pdu
    num_units: 2
    annotations:
      gui-x: "600"
      gui-y: "300"
    to:
      - "1"

  # switch DELL N2048P
  switch-dell-n2048p:
    charm: ./dist/trusty/switch-dell-n2048p
    num_units: 1
    annotations:
      gui-x: "900"
      gui-y: "300"
    to:
      - "2"

  # switch MERAKI MS425
  switch-meraki-ms425:
    charm: ./dist/trusty/switch-meraki-ms425
    num_units: 1
    annotations:
      gui-x: "1200"
      gui-y: "300"
    to:
      - "2"

  # server 3650 has RAID inheritance
  server-m3650:
    charm: ./dist/trusty/server-m3650
    num_units: 1
    annotations:
      gui-x: "300"
      gui-y: "600"
    to:
      - "3"

  # server 3550 has no RAID by default
  # build RAID using relation
  server-m3550:
    charm: ./dist/trusty/server-m3550
    num_units: 1
    annotations:
      gui-x: "600"
      gui-y: "600"
    to:
      - "3"

  # RAID adapter DELL H330
  raid-dell-h330:
    charm: ./dist/trusty/raid-dell-h330
    num_units: 1
    annotations:
      gui-x: "300"
      gui-y: "900"
    to:
      - "4"

  # generic storage
  storage:
    charm: ./dist/trusty/storage
    num_units: 5
    annotations:
      gui-x: "600"
      gui-y: "900"
    to:
      - "4"

# default series, n/a in modeling
series: xenial

# relations
relations:
  # rack to PDU relation
  - - "rack:pdu" # require
    - "pdu:rack" # provide

  # rack to server relation
  - - "server-m3650:rack"
    - "rack:server-m3650"

  # rack to server relation
  - - "server-m3550:rack"
    - "rack:server-m3550"

  # server to raid relation
  - - "raid-dell-h330:server-m3550"
    - "server-m3550:raid-dell-h330"

  # server to storage relation
  - - "server-m3650:storage"
    - "storage:server-m3650"
  - - "server-m3550:storage"
    - "storage:server-m3550"
